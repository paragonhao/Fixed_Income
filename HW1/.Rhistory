length(seq(120,0,-1))
d <- (1+r)^(seq(120,0,-1))
r <- 0.04
d <- (1+r)^(seq(120,0,-1))
d
(seq(120,0,-1))
d <- (1+r)^(seq(120,0,-1))
d
d * cf
accSum <- sum(d * cf)
accSum
cf <- c(1014000, rep(14000, 119))
cf
lenght(cf)
length(cf)
d <- (1+r)^(seq(119,0,-1))
d
cf <- c(1014000, rep(14000, 119))
r <- 0.04
d <- (1+r)^(seq(119,0,-1))
accSum <- sum(d * cf)
accSum
p <- div /(r - g)
g <- 0.03
div <- 10
r <- 0.12
p <- div /(r - g)
p
g <- 0.03
div <- 10
r <- 0.12
p <- div /(r - g)
cat("Willing to pay  ", p)
g <- 0.03
div <- 10
r <- 0.12
p <- div /(r - g)
cat("Willing to pay: ", p)
cf <- c(rep(5,49),100)
cf
ytm <- 0.01 # semiannual payment
cf <- c(rep(5,49),105) # cf of 5 dollar every 6 month
discount <- 1 / (ytm + 1)^seq(1,50,1)
price <- sum(cf * discount)
cat("Bond price is ", price)
discount
seq(1,5,1)
(1+r)^seq(1,5,1)
(1+r)^seq(0,5,1)
(1+r)^seq(0,4,1)
(1+r)^seq(0,5,1)
cf1 * (1+r)^seq(0,5,1)
cf1 <- 1000
r <- 0.1
cf1 * (1+r)^seq(0,5,1)
cf <- c(cf1, rep(cf1[6], 24))
cf
cf1[6]
cf <- cf1 * (1+r)^seq(0,5,1)
cf
cf <- c(cf, rep(cf1[6], 24))
cf
cf <- c(cf, rep(cf[6], 24))
cf
rep(cf[6]
rep(cf[6], 24)
rep(cf[6], 24)
cf <- c(cf, rep(cf[6], 24))
cf
cf
cf1 <- 1000
r <- 0.1
cf <- cf1 * (1+r)^seq(0,5,1)
cf
cf <- c(cf, rep(1610.51,24))
cf
length(cf)
cf
seq(1,30,1)
1.035^(seq(1,30,1))
discount <- 1.035^(seq(1,30,1))
discount
discount <- 1/(1.035^(seq(1,30,1)))
discount
cf * discount
cf1 <- 1000
r <- 0.1
cf <- cf1 * (1+r)^seq(0,5,1)
cf <- c(cf, rep(1610.51,24))
discount <- 1/(1.035^(seq(1,30,1)))
pv <- sum(cf * discount)
pv
45-21 + 1
seq(1,30,1)
1.03^(seq(1,(45-21+1)),1))
# 25 years in total
1.03^(seq(1,(45-21+1)),1)
1.03^(seq(1,(45-21+1),1)
seq(1,(45-21+1),1)
1.03^(seq(1,25,1))
discount <- 1/1.03^(seq(1,25,1))
discount
annuity <- 10000
# 25 years in total
n <- 25
discount <- 1/1.03^(seq(1,n,1))
cf <- rep(annuity, n)
cf
discount
pv_21 <- cf * discount
pv_21
pv <- pv_21 /((1.03)^20)
annuity <- 10000
# 25 years in total
n <- 25
discount <- 1/1.03^(seq(1,n,1))
cf <- rep(annuity, n)
pv_21 <- cf * discount
pv <- pv_21 /((1.03)^20)
pv
pv_21
annuity <- 10000
# 25 years in total
n <- 25
discount <- 1/1.03^(seq(1,n,1))
cf <- rep(annuity, n)
pv_21 <- sum(cf * discount)
pv <- pv_21 /((1.03)^20)
pv
FV <- 1000
r <- 0.03
FV*r
FV <- 1000
r <- 0.03
cf <- rep(FV*r, 40)
cf
FV <- 1000
r <- 0.03
cf <- c(rep(FV*r, 39),1040)
cf
FV <- 1000
r <- 0.03
cf <- c(rep(FV*r, 39),1030)
cf
length(cf)
library(FinancialMath)
times <- seq(1,20,0.5)
times
library(FinancialMath)
FV <- 1000
r <- 0.0
cf <- c(rep(FV*r, 39),1030)
cf0 <- 893.22
times <- seq(1,20,0.5)
IRR(cf0,cf,times,plot=FALSE)
length(cf)
times
library(FinCal)
irr(cf)
FV <- 1000
r <- 0.0
cf <- c(rep(FV*r, 39),1030)
irr(cf)
library(FinCal)
FV <- 1000
r <- 0.0
cf <- c(rep(FV*r, 39),1030)
cf0 <- 893.22
times <- seq(1,40)
IRR(cf0,cf,times,plot=FALSE)
IRR(cf0,cf,times,plot=FALSE)
IRR(cf0=cf0,cf=cf,times=times)
library(FinCal)
FV <- 1000
r <- 0.0
cf <- c(rep(FV*r, 39),1030)
cf0 <- 893.22
times <- seq(1,40)
IRR(cf0=cf0,cf=cf,times=times)
times
cf0
IRR(cf0=-cf0,cf=cf,times=times)
cf
FV <- 1000
r <- 0.0
cf <- c(rep(FV*r, 39),1030)
cf
library(FinCal)
FV <- 1000
r <- 0.03
cf <- c(rep(FV*r, 39),1030)
cf0 <- 893.22
times <- seq(1,40)
FV
r
cf
cf0
times
IRR(cf0=-cf0,cf=cf,times=times)
IRR(cf0=-cf0,cf=cf,times=times)
cf0
cf
library(FinCal)
FV <- 1000
r <- 0.03
cf <- c(rep(FV*r, 39),1030)
cf0 <- 893.22
times <- seq(1,40)
IRR(cf0=cf0,cf=cf,times=times)
irr(cf0=cf0,cf=cf,times=times)
cf1 <- c(rep(FV*r, 39),1030)
FV <- 1000
r <- 0.03
cf1 <- c(rep(FV*r, 39),1030)
cf1
library(FinCal)
FV <- 1000
r <- 0.03
cf1 <- c(rep(FV*r, 39),1030)
cf <- c(-893.22, cf1)
cf
cf1
library(FinCal)
FV <- 1000
r <- 0.03
cf1 <- c(rep(FV*r, 39),1030)
cf <- c(-893.22, cf1)
irr(cf)
library(FinCal)
FV <- 1000
r <- 0.03
cf1 <- c(rep(FV*r, 39),1030)
cf <- c(-893.22, cf1)
cat("YTM is: ", irr(cf))
library(FinCal)
FV <- 1000
r <- 0.03
cf1 <- c(rep(FV*r, 39),1030)
cf <- c(-893.22, cf1)
cat("YTM is: ", irr(cf))
cf <- 6.25
discount <- 0.07
price <- cf/(discount/2)
cat("willing to pay ", price)
cf <- c(1014000, rep(14000, 119))
r <- 0.04/12
d <- (1+r)^(seq(119,0,-1))
accSum <- sum(d * cf)
cat("Accummulative sum is ", accSum)
0.04/12
accSum
# read in data as data.table
STRIPData <- as.data.table(read.csv("case_2.csv",header = TRUE,sep = ","))
require(data.table)
# read in data as data.table
STRIPData <- as.data.table(read.csv("case_2.csv",header = TRUE,sep = ","))
STRIPData
require(data.table)
# read in data as data.table
STRIPData <- as.data.table(read.csv("case_2.csv",header = TRUE,sep = ","))
colnames(STRIPData) <-c("Date","Principla_Strip","Coupon_Strip")
STRIPData
require(data.table)
# read in data as data.table
STRIPData <- as.data.table(read.csv("case_2.csv",header = TRUE,sep = ","))
colnames(STRIPData) <-c("Date","Principal_Strip","Coupon_Strip")
STRIPData
ytm <- 0.01 # semiannual payment
cf <- c(rep(5,49),105) # cf of 5 dollar every 6 month
discount <- 1 / (ytm + 1)^seq(1,50,1)
price <- sum(cf * discount)
cat("Bond price is ", price)
cf <- 6.25
discount <- 0.07
price <- cf/(discount/2)
cat("willing to pay ", price)
# figure out the cash flow
cf <- c(1014000, rep(14000, 119))
r <- 0.04/12
d <- (1+r)^(seq(119,0,-1))
accSum <- sum(d * cf)
cat("Accummulative sum is ", accSum)
# figure out the cash flow
cf <- c(1014000, rep(14000, 119))
r <- 0.04/12
d <- (1+r)^(seq(120,1,-1))
accSum <- sum(d * cf)
cat("Accummulative sum is ", accSum)
# figure out the cash flow
cf <- c(1014000, rep(14000, 119))
r <- 0.04/12
d <- (1+r)^(seq(119,0,-1))
accSum <- sum(d * cf)
cat("Accummulative sum is ", accSum)
# figure out the cash flow
cf <- c(1014000, rep(14000, 119))
r <- 0.04/12
d <- (1+r)^(seq(120,1,-1))
accSum <- sum(d * cf)
cat("Accummulative sum is ", accSum)
g <- 0.03
div <- 10
r <- 0.12
p <- div /(r - g)
cat("Willing to pay: ", p)
cf1 <- 1000
r <- 0.1
cf <- cf1 * (1+r)^seq(0,5,1)
cf <- c(cf, rep(1610.51,24))
discount <- 1/(1.035^(seq(1,30,1)))
pv <- sum(cf * discount)
cat("PV: ", pv)
annuity <- 10000
# 25 years in total
n <- 25
discount <- 1/1.03^(seq(1,n,1))
cf <- rep(annuity, n)
pv_21 <- sum(cf * discount)
pv <- pv_21 /((1.03)^20)
cat("Annuity PV: ", pv)
annuity <- 10000
# 25 years in total
n <- 25
discount <- 1/1.03^(seq(1,n,1))
cf <- rep(annuity, n)
pv_21 <- sum(cf * discount)
pv <- pv_21 /((1.03)^19)
cat("Annuity PV: ", pv)
annuity <- 10000
# 25 years in total
n <- 24
discount <- 1/1.03^(seq(1,n,1))
cf <- rep(annuity, n)
pv_21 <- sum(cf * discount)
pv_21
annuity <- 10000
# 25 years in total
n <- 24
discount <- 1/1.03^(seq(1,n,1))
cf <- rep(annuity, n)
pv_21 <- sum(cf * discount)
pv <- pv_21 /((1.03)^20)
cat("Annuity PV: ", pv)
annuity <- 10000
# 25 years in total
n <- 24
discount <- 1/1.03^(seq(1,n,1))
cf <- rep(annuity, n)
pv_21 <- sum(cf * discount)
pv <- pv_21 /((1.03)^20)
cat("Annuity PV: ", pv)
library(FinCal)
FV <- 1000
r <- 0.03
cf1 <- c(rep(FV*r, 39),1030)
cf <- c(-893.22, cf1)
cat("YTM is: ", irr(cf))
cf1
library(FinCal)
FV <- 1000
r <- 0.03
cf1 <- c(rep(FV*r, 39),1030)
cf <- c(-893.22, cf1)
cat("YTM is: ", irr(cf)*2)
plot(x=c(3.125,3.75,4.375,4.75),y=c(112,125,137,144))
plot(x=c(3.125,3.75,4.375,4.75),y=c(112,125,137,144),type="l")
ytm <- 0.01 # semiannual payment
cf <- c(rep(5,49),105) # cf of 5 dollar every 6 month
discount <- 1 / (ytm + 1)^seq(1,50,1)
price <- sum(cf * discount)
cat("Bond price is ", price)
cf <- 6.25
discount <- 0.07
price <- cf/(discount/2)
cat("willing to pay ", price)
g <- 0.03
div <- 10
r <- 0.12
p <- div /(r - g)
cat("Willing to pay: ", p)
# figure out the cash flow
cf <- c(1014000, rep(14000, 119))
r <- 0.04/12
d <- (1+r)^(seq(120,1,-1))
accSum <- sum(d * cf)
cat("Accummulative sum is ", accSum)
cf <- rep(14000,120)
cf
(seq(120,1,-1))
d <- (1+r)^(seq(120,1,-1))
d
d * cf
sum(d * cf)
accSum <- sum(d * cf) + 1000000*(1+r)^120
accSum
cat("Accummulative sum is ", accSum)
cf <- rep(14000,120)
r <- 0.04/12
d <- (1+r)^(seq(119,1,-1))
accSum <- sum(d * cf) + 1000000*(1+r)^120
cat("Accummulative sum is ", accSum)
cf <- rep(14000,120)
r <- 0.04/12
d <- (1+r)^(seq(119,0,-1))
accSum <- sum(d * cf) + 1000000*(1+r)^120
cat("Accummulative sum is ", accSum)
cf1 <- 1000
r <- 0.1
cf <- cf1 * (1+r)^seq(0,5,1)
cf <- c(cf, rep(1610.51,24))
discount <- 1/(1.035^(seq(1,30,1)))
pv <- sum(cf * discount)
cat("PV: ", pv)
annuity <- 10000
# 25 years in total
n <- 24
discount <- 1/1.03^(seq(1,n,1))
cf <- rep(annuity, n)
pv_21 <- sum(cf * discount)
pv <- pv_21 /((1.03)^20)
cat("Annuity PV: ", pv)
annuity <- 10000
# 25 years in total
n <- 45
discount <- 1/1.03^(seq(1,n,1))
cf <- rep(annuity, n)
pv_21 <- sum(cf * discount)
pv_21
annuity <- 10000
# 25 years in total
n <- 25
discount <- 1/1.03^(seq(1,n,1))
cf <- rep(annuity, n)
pv_21 <- sum(cf * discount)
pv <- pv_21 /((1.03)^20)
cat("Annuity PV: ", pv)
98 + 18.5/32
143 + 2/32
as.date('11/15/2014','%m/%d/%Y')
as.Date('11/15/2014','%m/%d/%Y')
as.Date('01/09/2015','%m/%d/%Y') -as.Date('11/15/2014','%m/%d/%Y')
daysSincePayment <- as.Date('01/09/2015','%m/%d/%Y') - as.Date('11/15/2014','%m/%d/%Y')
daysInBetweenPayments <- as.Date('11/15/2015','%m/%d/%Y') - as.Date('11/15/2014','%m/%d/%Y')
daysInBetweenPayments
daysSincePayment
daysInBetweenPayments
dirty_priceA <- (daysSincePayment/daysInBetweenPayments) * (1.625/2) + 98.57812
(daysSincePayment/daysInBetweenPayments)
daysSincePayment <- as.Date('01/09/2015','%m/%d/%Y') - as.Date('11/15/2014','%m/%d/%Y')
daysInBetweenPayments <- 182
daysSincePayment <- as.Date('01/09/2015','%m/%d/%Y') - as.Date('11/15/2014','%m/%d/%Y')
daysSincePayment
daysSincePayment <- as.numeric(as.Date('01/09/2015','%m/%d/%Y') - as.Date('11/15/2014','%m/%d/%Y'))
daysSincePayment
(daysSincePayment/daysInBetweenPayments) * (1.625/2) + 98.57812
daysSincePayment <- as.numeric(as.Date('01/09/2015','%m/%d/%Y') - as.Date('11/15/2014','%m/%d/%Y'))
daysInBetweenPayments <- 182
dirty_priceA <- (daysSincePayment/daysInBetweenPayments) * (1.625/2) + 98.57812
dirty_priceB <- (daysSincePayment/daysInBetweenPayments) * (7.625/2) + 143.0625
cat("Dirty price for A: ", dirty_priceA)
cat("Dirty price for B: ",dirty_priceB)
daysSincePayment <- as.numeric(as.Date('01/09/2015','%m/%d/%Y') - as.Date('11/15/2014','%m/%d/%Y'))
daysInBetweenPayments <- 182
dirty_priceA <- (daysSincePayment/daysInBetweenPayments) * (1.625/2) + 98.57812
dirty_priceB <- (daysSincePayment/daysInBetweenPayments) * (7.625/2) + 143.0625
cat("Dirty price for A: ", dirty_priceA,"\n")
cat("Dirty price for B: ", dirty_priceB)
a <- (7.626 -1.625) / 7.625
bondAPrice <- 98.57812
bondARate <- 1.625
bondBPrice <- 143.0625
bondBRate <- 7.625
bondAPrice <- 98.57812
bondARate <- 1.625
bondBPrice <- 143.0625
bondBRate <- 7.625
daysSincePayment <- as.numeric(as.Date('01/09/2015','%m/%d/%Y') - as.Date('11/15/2014','%m/%d/%Y'))
daysInBetweenPayments <- 182
dirty_priceA <- (daysSincePayment/daysInBetweenPayments) * (bondARate/2) + bondAPrice
dirty_priceB <- (daysSincePayment/daysInBetweenPayments) * (bondBRate/2) + bondBPrice
cat("Dirty price for A: ", dirty_priceA,"\n")
cat("Dirty price for B: ", dirty_priceB)
bondPrice <- a * 86.15 + (1-a) * 143.0625
a <- (7.626 -1.625) / 7.625
cat("a: ",a,"\n")
bondPrice <- a * 86.15 + (1-a) * 143.0625
bondPrice
a <- (7.626 -1.625) / 7.625
cat("a: ",a,"\n")
bondPrice <- a * 86.15 + (1-a) * 143.0625
cat("Bond price for the replicated bond is: ",bondPrice)
a <- (7.626 -1.625) / 7.625
cat("a: ",a,"\n")
bondPrice <- a * 86.15 + (1-a) * 143.0625
cat("Bond price for the replicated bond is: ",bondPrice,"\n")
cat("This price is lower than the dirty price for bond with coupon rate 1.625")
a <- (7.626 -1.625) / 7.625
cat("a: ",a,"\n")
bondPrice <- a * 86.15 + (1-a) * 143.0625
cat("Bond price for the replicated bond is: ",bondPrice,"\n")
cat("This price is lower than the dirty price for bond with coupon rate 1.625, which is ",dirty_priceA)
dirty_priceA
(daysSincePayment/daysInBetweenPayments) * (bondARate/2)
a
bondPrice
bondPrice <- a * 86.15 + (1-a) * dirty_priceB
bondPrice
a <- (7.626 -1.625) / 7.625
cat("a: ",a,"\n")
bondPrice <- a * 86.15 + (1-a) * dirty_priceB
cat("Bond price for the replicated bond is: ",bondPrice,"\n")
cat("This price is lower than the dirty price for bond with coupon rate 1.625, which is ",dirty_priceA)
